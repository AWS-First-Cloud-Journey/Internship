{"ast":null,"code":"var _jsxFileName = \"D:\\\\Project\\\\frontend\\\\src\\\\components\\\\Messages.js\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Messages = () => {\n  _s2();\n  var _s = $RefreshSig$();\n  const [conversations, setConversations] = useState([]);\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [replyTo, setReplyTo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showAppointmentModal, setShowAppointmentModal] = useState(false);\n  const [conversationAppointments, setConversationAppointments] = useState([]);\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n  useEffect(() => {\n    fetchConversations();\n  }, []);\n  useEffect(() => {\n    if (selectedConversation) {\n      fetchMessages(selectedConversation.id);\n      markMessagesAsRead(selectedConversation.id);\n      fetchConversationAppointments(selectedConversation.id);\n      const interval = setInterval(() => {\n        fetchMessages(selectedConversation.id);\n        markMessagesAsRead(selectedConversation.id);\n        fetchConversationAppointments(selectedConversation.id);\n      }, 3000);\n      return () => clearInterval(interval);\n    }\n  }, [selectedConversation]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const fetchConversations = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get('/api/conversations', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setConversations(response.data);\n    } catch (error) {\n      console.error('Error fetching conversations:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchMessages = async conversationId => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`/api/conversations/${conversationId}/messages`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setMessages(response.data);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n  const markMessagesAsRead = async conversationId => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`/api/conversations/${conversationId}/mark-read`, {}, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      // Trigger navbar count update\n      window.dispatchEvent(new Event('messageCountUpdate'));\n    } catch (error) {\n      console.error('Error marking messages as read:', error);\n    }\n  };\n  const fetchConversationAppointments = async conversationId => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`/api/conversations/${conversationId}/appointments`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setConversationAppointments(response.data);\n    } catch (error) {\n      console.error('Error fetching appointments:', error);\n    }\n  };\n  const createAppointment = async appointmentData => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`/api/conversations/${selectedConversation.id}/appointments`, appointmentData, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      fetchConversationAppointments(selectedConversation.id);\n      fetchMessages(selectedConversation.id);\n      setShowAppointmentModal(false);\n    } catch (error) {\n      console.error('Error creating appointment:', error);\n    }\n  };\n  const sendMessage = async e => {\n    var _fileInputRef$current;\n    e.preventDefault();\n    if (!newMessage.trim() && !((_fileInputRef$current = fileInputRef.current) !== null && _fileInputRef$current !== void 0 && _fileInputRef$current.files[0])) return;\n    try {\n      var _fileInputRef$current2;\n      const token = localStorage.getItem('token');\n      const formData = new FormData();\n      if ((_fileInputRef$current2 = fileInputRef.current) !== null && _fileInputRef$current2 !== void 0 && _fileInputRef$current2.files[0]) {\n        formData.append('file', fileInputRef.current.files[0]);\n        formData.append('message_type', 'image');\n      } else {\n        formData.append('message_type', 'text');\n      }\n      formData.append('content', newMessage);\n      if (replyTo) {\n        formData.append('reply_to_id', replyTo.id);\n      }\n      await axios.post(`/api/conversations/${selectedConversation.id}/messages`, formData, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      setNewMessage('');\n      setReplyTo(null);\n      if (fileInputRef.current) fileInputRef.current.value = '';\n      fetchMessages(selectedConversation.id);\n      // Trigger navbar count update\n      window.dispatchEvent(new Event('messageCountUpdate'));\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const editMessage = async (messageId, newContent) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.put(`/api/messages/${messageId}`, {\n        content: newContent\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      fetchMessages(selectedConversation.id);\n    } catch (error) {\n      console.error('Error editing message:', error);\n    }\n  };\n  const deleteMessage = async messageId => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.delete(`/api/messages/${messageId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      fetchMessages(selectedConversation.id);\n    } catch (error) {\n      console.error('Error deleting message:', error);\n    }\n  };\n  const shareLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(async position => {\n        try {\n          const token = localStorage.getItem('token');\n          await axios.post(`/api/conversations/${selectedConversation.id}/messages`, {\n            message_type: 'location',\n            location_lat: position.coords.latitude,\n            location_lng: position.coords.longitude,\n            location_name: 'Current Location'\n          }, {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          fetchMessages(selectedConversation.id);\n        } catch (error) {\n          console.error('Error sharing location:', error);\n        }\n      });\n    }\n  };\n  const MessageBubble = ({\n    message,\n    isOwn\n  }) => {\n    _s();\n    const [isEditing, setIsEditing] = useState(false);\n    const [editContent, setEditContent] = useState(message.content);\n    const currentUser = JSON.parse(localStorage.getItem('user'));\n\n    // System messages (appointment notifications)\n    if (message.message_type === 'system') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          marginBottom: '1rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: '#f0f8ff',\n            color: '#666',\n            padding: '0.5rem 1rem',\n            borderRadius: '12px',\n            fontSize: '0.9rem',\n            border: '1px solid #e0e8f0'\n          },\n          children: [message.content, /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '0.7rem',\n              opacity: 0.7,\n              marginTop: '0.25rem',\n              textAlign: 'center'\n            },\n            children: new Date(message.created_at).toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: isOwn ? 'flex-end' : 'flex-start',\n        marginBottom: '1rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxWidth: '70%',\n          background: isOwn ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#f1f1f1',\n          color: isOwn ? 'white' : 'black',\n          padding: '0.75rem 1rem',\n          borderRadius: '18px',\n          position: 'relative'\n        },\n        children: [message.reply_to && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'rgba(0,0,0,0.1)',\n            padding: '0.5rem',\n            borderRadius: '8px',\n            marginBottom: '0.5rem',\n            fontSize: '0.8rem',\n            borderLeft: '3px solid rgba(255,255,255,0.5)'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [message.reply_to.sender_username, \":\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: message.reply_to.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 13\n        }, this), message.message_type === 'image' && message.file_url && /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `/api/uploads/${message.file_url}`,\n          alt: \"Shared image\",\n          style: {\n            maxWidth: '200px',\n            borderRadius: '8px',\n            marginBottom: '0.5rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }, this), message.message_type === 'location' && message.location && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '0.5rem'\n          },\n          children: [\"\\uD83D\\uDCCD \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: message.location.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 18\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            children: [\"Lat: \", message.location.lat, \", Lng: \", message.location.lng]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 13\n        }, this), isEditing ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            value: editContent,\n            onChange: e => setEditContent(e.target.value),\n            style: {\n              width: '100%',\n              padding: '0.25rem',\n              marginBottom: '0.5rem'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                editMessage(message.id, editContent);\n                setIsEditing(false);\n              },\n              style: {\n                marginRight: '0.5rem',\n                fontSize: '0.7rem'\n              },\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setIsEditing(false),\n              style: {\n                fontSize: '0.7rem'\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [message.content, message.is_edited && /*#__PURE__*/_jsxDEV(\"small\", {\n            style: {\n              opacity: 0.7\n            },\n            children: \" (edited)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '0.7rem',\n            opacity: 0.7,\n            marginTop: '0.25rem'\n          },\n          children: new Date(message.created_at).toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this), isOwn && message.sender_id === currentUser.id && !message.is_deleted && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '-10px',\n            right: '0',\n            display: 'none'\n          },\n          className: \"message-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setReplyTo(message),\n            style: {\n              fontSize: '0.6rem',\n              margin: '0 2px'\n            },\n            children: \"Reply\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setIsEditing(true),\n            style: {\n              fontSize: '0.6rem',\n              margin: '0 2px'\n            },\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => deleteMessage(message.id),\n            style: {\n              fontSize: '0.6rem',\n              margin: '0 2px'\n            },\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this);\n  };\n  _s(MessageBubble, \"DpywK8biuty2ZFnG3bN/3+ipFiE=\");\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center',\n      padding: '2rem'\n    },\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 305,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: '1200px',\n      margin: '0 auto',\n      padding: '2rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        marginBottom: '3rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        style: {\n          color: 'white',\n          textDecoration: 'none',\n          padding: '0.75rem 1.5rem',\n          background: 'linear-gradient(135deg, #ff6b6b 0%, #feca57 100%)',\n          borderRadius: '12px',\n          fontWeight: '500',\n          transition: 'all 0.3s ease',\n          marginRight: '2rem',\n          boxShadow: '0 4px 15px rgba(255, 107, 107, 0.4)'\n        },\n        children: \"\\u2190 Home\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          fontSize: '2.5rem',\n          fontWeight: '700',\n          background: 'linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3)',\n          WebkitBackgroundClip: 'text',\n          WebkitTextFillColor: 'transparent',\n          backgroundSize: '400% 400%',\n          animation: 'rainbow 3s ease-in-out infinite'\n        },\n        children: \"Messages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        height: '600px',\n        background: 'rgba(255, 255, 255, 0.95)',\n        borderRadius: '16px',\n        overflow: 'hidden'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '300px',\n          borderRight: '1px solid #eee',\n          overflow: 'auto'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '1rem',\n            borderBottom: '1px solid #eee'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Conversations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this), conversations.map(conv => {\n          var _conv$last_message$co;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => setSelectedConversation(conv),\n            style: {\n              padding: '1rem',\n              borderBottom: '1px solid #f0f0f0',\n              cursor: 'pointer',\n              background: (selectedConversation === null || selectedConversation === void 0 ? void 0 : selectedConversation.id) === conv.id ? '#f0f8ff' : 'transparent',\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: conv.unread_count > 0 ? 'bold' : 'normal'\n                },\n                children: conv.other_user.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 17\n              }, this), conv.unread_count > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  backgroundColor: '#e74c3c',\n                  color: 'white',\n                  borderRadius: '50%',\n                  width: '20px',\n                  height: '20px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '0.7rem',\n                  fontWeight: 'bold'\n                },\n                children: conv.unread_count\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 15\n            }, this), conv.item && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '0.8rem',\n                color: '#666'\n              },\n              children: [\"About: \", conv.item.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 29\n            }, this), conv.last_message && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '0.8rem',\n                color: conv.unread_count > 0 ? '#333' : '#999',\n                marginTop: '0.25rem',\n                fontWeight: conv.unread_count > 0 ? '500' : 'normal'\n              },\n              children: [(_conv$last_message$co = conv.last_message.content) === null || _conv$last_message$co === void 0 ? void 0 : _conv$last_message$co.substring(0, 50), \"...\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this)]\n          }, conv.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column'\n        },\n        children: selectedConversation ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: '1rem',\n              borderBottom: '1px solid #eee',\n              background: '#f8f9fa'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: selectedConversation.other_user.username\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 21\n                }, this), selectedConversation.item && /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [\"Discussing: \", selectedConversation.item.name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 396,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setShowAppointmentModal(true),\n                style: {\n                  background: '#f39c12',\n                  color: 'white',\n                  border: 'none',\n                  padding: '0.5rem 1rem',\n                  borderRadius: '8px',\n                  cursor: 'pointer',\n                  fontSize: '0.9rem'\n                },\n                children: \"\\uD83D\\uDCC5 Schedule\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 17\n            }, this), conversationAppointments.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '1rem',\n                padding: '0.75rem',\n                background: '#e8f4fd',\n                borderRadius: '8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.9rem',\n                  fontWeight: 'bold',\n                  marginBottom: '0.5rem'\n                },\n                children: \"Appointments:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 418,\n                columnNumber: 21\n              }, this), conversationAppointments.map(apt => /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => window.location.href = '/appointments',\n                style: {\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  alignItems: 'center',\n                  padding: '0.5rem',\n                  background: 'white',\n                  borderRadius: '6px',\n                  marginBottom: '0.25rem',\n                  cursor: 'pointer',\n                  fontSize: '0.8rem'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"\\uD83D\\uDCC5 \", new Date(apt.appointment_time).toLocaleDateString(), \" at \", new Date(apt.appointment_time).toLocaleTimeString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 435,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    background: apt.status === 'confirmed' ? '#2ecc71' : apt.status === 'pending' ? '#f39c12' : '#e74c3c',\n                    color: 'white',\n                    padding: '0.2rem 0.5rem',\n                    borderRadius: '12px',\n                    fontSize: '0.7rem'\n                  },\n                  children: apt.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 436,\n                  columnNumber: 25\n                }, this)]\n              }, apt.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 23\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 417,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              padding: '1rem',\n              overflow: 'auto'\n            },\n            children: [messages.map(message => /*#__PURE__*/_jsxDEV(MessageBubble, {\n              message: message,\n              isOwn: message.sender_id === JSON.parse(localStorage.getItem('user')).id\n            }, message.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: messagesEndRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 15\n          }, this), replyTo && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: '0.5rem 1rem',\n              background: '#f0f8ff',\n              borderTop: '1px solid #eee'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"small\", {\n              children: [\"Replying to: \", replyTo.content]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setReplyTo(null),\n              style: {\n                float: 'right',\n                background: 'none',\n                border: 'none'\n              },\n              children: \"\\u2715\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: sendMessage,\n            style: {\n              padding: '1rem',\n              borderTop: '1px solid #eee',\n              display: 'flex',\n              gap: '0.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              ref: fileInputRef,\n              accept: \"image/*\",\n              style: {\n                display: 'none'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => {\n                var _fileInputRef$current3;\n                return (_fileInputRef$current3 = fileInputRef.current) === null || _fileInputRef$current3 === void 0 ? void 0 : _fileInputRef$current3.click();\n              },\n              style: {\n                padding: '0.5rem'\n              },\n              children: \"\\uD83D\\uDCF7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: shareLocation,\n              style: {\n                padding: '0.5rem'\n              },\n              children: \"\\uD83D\\uDCCD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: newMessage,\n              onChange: e => setNewMessage(e.target.value),\n              placeholder: \"Type a message...\",\n              style: {\n                flex: 1,\n                padding: '0.75rem',\n                border: '1px solid #ddd',\n                borderRadius: '20px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              style: {\n                padding: '0.5rem 1rem',\n                background: '#007bff',\n                color: 'white',\n                border: 'none',\n                borderRadius: '20px'\n              },\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            height: '100%'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select a conversation to start messaging\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      jsx: true,\n      children: `\n        .message-actions {\n          display: none;\n        }\n        div:hover .message-actions {\n          display: block;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 7\n    }, this), showAppointmentModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.7)',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        zIndex: 1000\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: 'rgba(255, 255, 255, 0.95)',\n          backdropFilter: 'blur(20px)',\n          borderRadius: '24px',\n          boxShadow: '0 20px 60px rgba(0,0,0,0.3)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          padding: '2rem',\n          maxWidth: '500px',\n          width: '90%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            marginBottom: '1rem'\n          },\n          children: \"Schedule Appointment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: e => {\n            e.preventDefault();\n            const formData = new FormData(e.target);\n            createAppointment({\n              appointment_time: formData.get('appointment_time'),\n              location: formData.get('location'),\n              notes: formData.get('notes')\n            });\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                display: 'block',\n                marginBottom: '0.5rem'\n              },\n              children: \"Date & Time:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 543,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"datetime-local\",\n              name: \"appointment_time\",\n              min: new Date().toISOString().slice(0, 16),\n              style: {\n                width: '100%',\n                padding: '0.5rem',\n                borderRadius: '4px',\n                border: '1px solid #ddd'\n              },\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                display: 'block',\n                marginBottom: '0.5rem'\n              },\n              children: \"Location:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 553,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"location\",\n              placeholder: \"Meeting location\",\n              style: {\n                width: '100%',\n                padding: '0.5rem',\n                borderRadius: '4px',\n                border: '1px solid #ddd'\n              },\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 552,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                display: 'block',\n                marginBottom: '0.5rem'\n              },\n              children: \"Notes:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              name: \"notes\",\n              placeholder: \"Additional notes...\",\n              rows: \"3\",\n              style: {\n                width: '100%',\n                padding: '0.5rem',\n                borderRadius: '4px',\n                border: '1px solid #ddd'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => setShowAppointmentModal(false),\n              style: {\n                flex: 1,\n                padding: '0.75rem',\n                background: '#95a5a6',\n                color: 'white',\n                border: 'none',\n                borderRadius: '8px'\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 572,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              style: {\n                flex: 1,\n                padding: '0.75rem',\n                background: '#f39c12',\n                color: 'white',\n                border: 'none',\n                borderRadius: '8px'\n              },\n              children: \"Create Appointment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 579,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 308,\n    columnNumber: 5\n  }, this);\n};\n_s2(Messages, \"n6X9yNFlitdTb2v0Wuy7YKVajlQ=\");\n_c = Messages;\nexport default Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Link","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","Messages","_s2","_s","$RefreshSig$","conversations","setConversations","selectedConversation","setSelectedConversation","messages","setMessages","newMessage","setNewMessage","replyTo","setReplyTo","loading","setLoading","showAppointmentModal","setShowAppointmentModal","conversationAppointments","setConversationAppointments","messagesEndRef","fileInputRef","fetchConversations","fetchMessages","id","markMessagesAsRead","fetchConversationAppointments","interval","setInterval","clearInterval","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","token","localStorage","getItem","response","get","headers","data","error","console","conversationId","post","window","dispatchEvent","Event","createAppointment","appointmentData","sendMessage","e","_fileInputRef$current","preventDefault","trim","files","_fileInputRef$current2","formData","FormData","append","value","editMessage","messageId","newContent","put","content","deleteMessage","delete","shareLocation","navigator","geolocation","getCurrentPosition","position","message_type","location_lat","coords","latitude","location_lng","longitude","location_name","MessageBubble","message","isOwn","isEditing","setIsEditing","editContent","setEditContent","currentUser","JSON","parse","style","display","justifyContent","marginBottom","children","background","color","padding","borderRadius","fontSize","border","opacity","marginTop","textAlign","Date","created_at","toLocaleTimeString","fileName","_jsxFileName","lineNumber","columnNumber","maxWidth","reply_to","borderLeft","sender_username","file_url","src","alt","location","name","lat","lng","onChange","target","width","onClick","marginRight","is_edited","sender_id","is_deleted","top","right","className","margin","alignItems","to","textDecoration","fontWeight","transition","boxShadow","WebkitBackgroundClip","WebkitTextFillColor","backgroundSize","animation","height","overflow","borderRight","borderBottom","map","conv","_conv$last_message$co","cursor","unread_count","other_user","username","backgroundColor","item","last_message","substring","flex","flexDirection","length","apt","href","appointment_time","toLocaleDateString","status","ref","borderTop","float","onSubmit","gap","type","accept","_fileInputRef$current3","click","placeholder","jsx","left","bottom","zIndex","backdropFilter","notes","min","toISOString","slice","required","rows","_c","$RefreshReg$"],"sources":["D:/Project/frontend/src/components/Messages.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\n\nconst Messages = () => {\n  const [conversations, setConversations] = useState([]);\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [replyTo, setReplyTo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showAppointmentModal, setShowAppointmentModal] = useState(false);\n  const [conversationAppointments, setConversationAppointments] = useState([]);\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  useEffect(() => {\n    fetchConversations();\n  }, []);\n\n  useEffect(() => {\n    if (selectedConversation) {\n      fetchMessages(selectedConversation.id);\n      markMessagesAsRead(selectedConversation.id);\n      fetchConversationAppointments(selectedConversation.id);\n      const interval = setInterval(() => {\n        fetchMessages(selectedConversation.id);\n        markMessagesAsRead(selectedConversation.id);\n        fetchConversationAppointments(selectedConversation.id);\n      }, 3000);\n      return () => clearInterval(interval);\n    }\n  }, [selectedConversation]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const fetchConversations = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get('/api/conversations', {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      setConversations(response.data);\n    } catch (error) {\n      console.error('Error fetching conversations:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchMessages = async (conversationId) => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`/api/conversations/${conversationId}/messages`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      setMessages(response.data);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n  \n  const markMessagesAsRead = async (conversationId) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`/api/conversations/${conversationId}/mark-read`, {}, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      // Trigger navbar count update\n      window.dispatchEvent(new Event('messageCountUpdate'));\n    } catch (error) {\n      console.error('Error marking messages as read:', error);\n    }\n  };\n  \n  const fetchConversationAppointments = async (conversationId) => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`/api/conversations/${conversationId}/appointments`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      setConversationAppointments(response.data);\n    } catch (error) {\n      console.error('Error fetching appointments:', error);\n    }\n  };\n  \n  const createAppointment = async (appointmentData) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`/api/conversations/${selectedConversation.id}/appointments`, appointmentData, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      fetchConversationAppointments(selectedConversation.id);\n      fetchMessages(selectedConversation.id);\n      setShowAppointmentModal(false);\n    } catch (error) {\n      console.error('Error creating appointment:', error);\n    }\n  };\n\n  const sendMessage = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim() && !fileInputRef.current?.files[0]) return;\n\n    try {\n      const token = localStorage.getItem('token');\n      const formData = new FormData();\n      \n      if (fileInputRef.current?.files[0]) {\n        formData.append('file', fileInputRef.current.files[0]);\n        formData.append('message_type', 'image');\n      } else {\n        formData.append('message_type', 'text');\n      }\n      \n      formData.append('content', newMessage);\n      if (replyTo) {\n        formData.append('reply_to_id', replyTo.id);\n      }\n\n      await axios.post(`/api/conversations/${selectedConversation.id}/messages`, formData, {\n        headers: { \n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n\n      setNewMessage('');\n      setReplyTo(null);\n      if (fileInputRef.current) fileInputRef.current.value = '';\n      fetchMessages(selectedConversation.id);\n      // Trigger navbar count update\n      window.dispatchEvent(new Event('messageCountUpdate'));\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const editMessage = async (messageId, newContent) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.put(`/api/messages/${messageId}`, \n        { content: newContent },\n        { headers: { 'Authorization': `Bearer ${token}` } }\n      );\n      fetchMessages(selectedConversation.id);\n    } catch (error) {\n      console.error('Error editing message:', error);\n    }\n  };\n\n  const deleteMessage = async (messageId) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.delete(`/api/messages/${messageId}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      fetchMessages(selectedConversation.id);\n    } catch (error) {\n      console.error('Error deleting message:', error);\n    }\n  };\n\n  const shareLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(async (position) => {\n        try {\n          const token = localStorage.getItem('token');\n          await axios.post(`/api/conversations/${selectedConversation.id}/messages`, {\n            message_type: 'location',\n            location_lat: position.coords.latitude,\n            location_lng: position.coords.longitude,\n            location_name: 'Current Location'\n          }, {\n            headers: { 'Authorization': `Bearer ${token}` }\n          });\n          fetchMessages(selectedConversation.id);\n        } catch (error) {\n          console.error('Error sharing location:', error);\n        }\n      });\n    }\n  };\n\n  const MessageBubble = ({ message, isOwn }) => {\n    const [isEditing, setIsEditing] = useState(false);\n    const [editContent, setEditContent] = useState(message.content);\n    const currentUser = JSON.parse(localStorage.getItem('user'));\n\n    // System messages (appointment notifications)\n    if (message.message_type === 'system') {\n      return (\n        <div style={{\n          display: 'flex',\n          justifyContent: 'center',\n          marginBottom: '1rem'\n        }}>\n          <div style={{\n            background: '#f0f8ff',\n            color: '#666',\n            padding: '0.5rem 1rem',\n            borderRadius: '12px',\n            fontSize: '0.9rem',\n            border: '1px solid #e0e8f0'\n          }}>\n            {message.content}\n            <div style={{ fontSize: '0.7rem', opacity: 0.7, marginTop: '0.25rem', textAlign: 'center' }}>\n              {new Date(message.created_at).toLocaleTimeString()}\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div style={{\n        display: 'flex',\n        justifyContent: isOwn ? 'flex-end' : 'flex-start',\n        marginBottom: '1rem'\n      }}>\n        <div style={{\n          maxWidth: '70%',\n          background: isOwn ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#f1f1f1',\n          color: isOwn ? 'white' : 'black',\n          padding: '0.75rem 1rem',\n          borderRadius: '18px',\n          position: 'relative'\n        }}>\n          {message.reply_to && (\n            <div style={{\n              background: 'rgba(0,0,0,0.1)',\n              padding: '0.5rem',\n              borderRadius: '8px',\n              marginBottom: '0.5rem',\n              fontSize: '0.8rem',\n              borderLeft: '3px solid rgba(255,255,255,0.5)'\n            }}>\n              <strong>{message.reply_to.sender_username}:</strong>\n              <div>{message.reply_to.content}</div>\n            </div>\n          )}\n\n          {message.message_type === 'image' && message.file_url && (\n            <img \n              src={`/api/uploads/${message.file_url}`}\n              alt=\"Shared image\"\n              style={{ maxWidth: '200px', borderRadius: '8px', marginBottom: '0.5rem' }}\n            />\n          )}\n\n          {message.message_type === 'location' && message.location && (\n            <div style={{ marginBottom: '0.5rem' }}>\n               <strong>{message.location.name}</strong>\n              <br />\n              <small>Lat: {message.location.lat}, Lng: {message.location.lng}</small>\n            </div>\n          )}\n\n          {isEditing ? (\n            <div>\n              <input\n                value={editContent}\n                onChange={(e) => setEditContent(e.target.value)}\n                style={{ width: '100%', padding: '0.25rem', marginBottom: '0.5rem' }}\n              />\n              <div>\n                <button onClick={() => {\n                  editMessage(message.id, editContent);\n                  setIsEditing(false);\n                }} style={{ marginRight: '0.5rem', fontSize: '0.7rem' }}>Save</button>\n                <button onClick={() => setIsEditing(false)} style={{ fontSize: '0.7rem' }}>Cancel</button>\n              </div>\n            </div>\n          ) : (\n            <div>\n              {message.content}\n              {message.is_edited && <small style={{ opacity: 0.7 }}> (edited)</small>}\n            </div>\n          )}\n\n          <div style={{ fontSize: '0.7rem', opacity: 0.7, marginTop: '0.25rem' }}>\n            {new Date(message.created_at).toLocaleTimeString()}\n          </div>\n\n          {isOwn && message.sender_id === currentUser.id && !message.is_deleted && (\n            <div style={{ position: 'absolute', top: '-10px', right: '0', display: 'none' }} \n                 className=\"message-actions\">\n              <button onClick={() => setReplyTo(message)} style={{ fontSize: '0.6rem', margin: '0 2px' }}>Reply</button>\n              <button onClick={() => setIsEditing(true)} style={{ fontSize: '0.6rem', margin: '0 2px' }}>Edit</button>\n              <button onClick={() => deleteMessage(message.id)} style={{ fontSize: '0.6rem', margin: '0 2px' }}>Delete</button>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  if (loading) return <div style={{ textAlign: 'center', padding: '2rem' }}>Loading...</div>;\n\n  return (\n    <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '2rem' }}>\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '3rem' }}>\n        <Link to=\"/\" style={{\n          color: 'white',\n          textDecoration: 'none',\n          padding: '0.75rem 1.5rem',\n          background: 'linear-gradient(135deg, #ff6b6b 0%, #feca57 100%)',\n          borderRadius: '12px',\n          fontWeight: '500',\n          transition: 'all 0.3s ease',\n          marginRight: '2rem',\n          boxShadow: '0 4px 15px rgba(255, 107, 107, 0.4)'\n        }}> Home</Link>\n        <h2 style={{ \n          fontSize: '2.5rem',\n          fontWeight: '700',\n          background: 'linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3)',\n          WebkitBackgroundClip: 'text',\n          WebkitTextFillColor: 'transparent',\n          backgroundSize: '400% 400%',\n          animation: 'rainbow 3s ease-in-out infinite'\n        }}>Messages</h2>\n      </div>\n\n      <div style={{ display: 'flex', height: '600px', background: 'rgba(255, 255, 255, 0.95)', borderRadius: '16px', overflow: 'hidden' }}>\n        {/* Conversations List */}\n        <div style={{ width: '300px', borderRight: '1px solid #eee', overflow: 'auto' }}>\n          <div style={{ padding: '1rem', borderBottom: '1px solid #eee' }}>\n            <h3>Conversations</h3>\n          </div>\n          {conversations.map(conv => (\n            <div\n              key={conv.id}\n              onClick={() => setSelectedConversation(conv)}\n              style={{\n                padding: '1rem',\n                borderBottom: '1px solid #f0f0f0',\n                cursor: 'pointer',\n                background: selectedConversation?.id === conv.id ? '#f0f8ff' : 'transparent',\n                position: 'relative'\n              }}\n            >\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                <div style={{ fontWeight: conv.unread_count > 0 ? 'bold' : 'normal' }}>\n                  {conv.other_user.username}\n                </div>\n                {conv.unread_count > 0 && (\n                  <span style={{\n                    backgroundColor: '#e74c3c',\n                    color: 'white',\n                    borderRadius: '50%',\n                    width: '20px',\n                    height: '20px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: '0.7rem',\n                    fontWeight: 'bold'\n                  }}>\n                    {conv.unread_count}\n                  </span>\n                )}\n              </div>\n              {conv.item && <div style={{ fontSize: '0.8rem', color: '#666' }}>About: {conv.item.name}</div>}\n              {conv.last_message && (\n                <div style={{ \n                  fontSize: '0.8rem', \n                  color: conv.unread_count > 0 ? '#333' : '#999', \n                  marginTop: '0.25rem',\n                  fontWeight: conv.unread_count > 0 ? '500' : 'normal'\n                }}>\n                  {conv.last_message.content?.substring(0, 50)}...\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* Messages Area */}\n        <div style={{ flex: 1, display: 'flex', flexDirection: 'column' }}>\n          {selectedConversation ? (\n            <>\n              {/* Header */}\n              <div style={{ padding: '1rem', borderBottom: '1px solid #eee', background: '#f8f9fa' }}>\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                  <div>\n                    <h4>{selectedConversation.other_user.username}</h4>\n                    {selectedConversation.item && (\n                      <small>Discussing: {selectedConversation.item.name}</small>\n                    )}\n                  </div>\n                  <button\n                    onClick={() => setShowAppointmentModal(true)}\n                    style={{\n                      background: '#f39c12',\n                      color: 'white',\n                      border: 'none',\n                      padding: '0.5rem 1rem',\n                      borderRadius: '8px',\n                      cursor: 'pointer',\n                      fontSize: '0.9rem'\n                    }}\n                  >\n                     Schedule\n                  </button>\n                </div>\n                \n                {/* Appointments Header */}\n                {conversationAppointments.length > 0 && (\n                  <div style={{ marginTop: '1rem', padding: '0.75rem', background: '#e8f4fd', borderRadius: '8px' }}>\n                    <div style={{ fontSize: '0.9rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>Appointments:</div>\n                    {conversationAppointments.map(apt => (\n                      <div \n                        key={apt.id}\n                        onClick={() => window.location.href = '/appointments'}\n                        style={{\n                          display: 'flex',\n                          justifyContent: 'space-between',\n                          alignItems: 'center',\n                          padding: '0.5rem',\n                          background: 'white',\n                          borderRadius: '6px',\n                          marginBottom: '0.25rem',\n                          cursor: 'pointer',\n                          fontSize: '0.8rem'\n                        }}\n                      >\n                        <span> {new Date(apt.appointment_time).toLocaleDateString()} at {new Date(apt.appointment_time).toLocaleTimeString()}</span>\n                        <span style={{\n                          background: apt.status === 'confirmed' ? '#2ecc71' : apt.status === 'pending' ? '#f39c12' : '#e74c3c',\n                          color: 'white',\n                          padding: '0.2rem 0.5rem',\n                          borderRadius: '12px',\n                          fontSize: '0.7rem'\n                        }}>\n                          {apt.status}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Messages */}\n              <div style={{ flex: 1, padding: '1rem', overflow: 'auto' }}>\n                {messages.map(message => (\n                  <MessageBubble \n                    key={message.id} \n                    message={message} \n                    isOwn={message.sender_id === JSON.parse(localStorage.getItem('user')).id}\n                  />\n                ))}\n                <div ref={messagesEndRef} />\n              </div>\n\n              {/* Reply Preview */}\n              {replyTo && (\n                <div style={{ padding: '0.5rem 1rem', background: '#f0f8ff', borderTop: '1px solid #eee' }}>\n                  <small>Replying to: {replyTo.content}</small>\n                  <button onClick={() => setReplyTo(null)} style={{ float: 'right', background: 'none', border: 'none' }}></button>\n                </div>\n              )}\n\n              {/* Input Area */}\n              <form onSubmit={sendMessage} style={{ padding: '1rem', borderTop: '1px solid #eee', display: 'flex', gap: '0.5rem' }}>\n                <input\n                  type=\"file\"\n                  ref={fileInputRef}\n                  accept=\"image/*\"\n                  style={{ display: 'none' }}\n                />\n                <button type=\"button\" onClick={() => fileInputRef.current?.click()} style={{ padding: '0.5rem' }}></button>\n                <button type=\"button\" onClick={shareLocation} style={{ padding: '0.5rem' }}></button>\n                <input\n                  type=\"text\"\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                  placeholder=\"Type a message...\"\n                  style={{ flex: 1, padding: '0.75rem', border: '1px solid #ddd', borderRadius: '20px' }}\n                />\n                <button type=\"submit\" style={{ padding: '0.5rem 1rem', background: '#007bff', color: 'white', border: 'none', borderRadius: '20px' }}>Send</button>\n              </form>\n            </>\n          ) : (\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%' }}>\n              <p>Select a conversation to start messaging</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <style jsx>{`\n        .message-actions {\n          display: none;\n        }\n        div:hover .message-actions {\n          display: block;\n        }\n      `}</style>\n      \n      {/* Appointment Modal */}\n      {showAppointmentModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0, 0, 0, 0.7)',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: 'rgba(255, 255, 255, 0.95)',\n            backdropFilter: 'blur(20px)',\n            borderRadius: '24px',\n            boxShadow: '0 20px 60px rgba(0,0,0,0.3)',\n            border: '1px solid rgba(255, 255, 255, 0.2)',\n            padding: '2rem',\n            maxWidth: '500px',\n            width: '90%'\n          }}>\n            <h3 style={{ marginBottom: '1rem' }}>Schedule Appointment</h3>\n            <form onSubmit={(e) => {\n              e.preventDefault();\n              const formData = new FormData(e.target);\n              createAppointment({\n                appointment_time: formData.get('appointment_time'),\n                location: formData.get('location'),\n                notes: formData.get('notes')\n              });\n            }}>\n              <div style={{ marginBottom: '1rem' }}>\n                <label style={{ display: 'block', marginBottom: '0.5rem' }}>Date & Time:</label>\n                <input\n                  type=\"datetime-local\"\n                  name=\"appointment_time\"\n                  min={new Date().toISOString().slice(0, 16)}\n                  style={{ width: '100%', padding: '0.5rem', borderRadius: '4px', border: '1px solid #ddd' }}\n                  required\n                />\n              </div>\n              <div style={{ marginBottom: '1rem' }}>\n                <label style={{ display: 'block', marginBottom: '0.5rem' }}>Location:</label>\n                <input\n                  type=\"text\"\n                  name=\"location\"\n                  placeholder=\"Meeting location\"\n                  style={{ width: '100%', padding: '0.5rem', borderRadius: '4px', border: '1px solid #ddd' }}\n                  required\n                />\n              </div>\n              <div style={{ marginBottom: '1rem' }}>\n                <label style={{ display: 'block', marginBottom: '0.5rem' }}>Notes:</label>\n                <textarea\n                  name=\"notes\"\n                  placeholder=\"Additional notes...\"\n                  rows=\"3\"\n                  style={{ width: '100%', padding: '0.5rem', borderRadius: '4px', border: '1px solid #ddd' }}\n                />\n              </div>\n              <div style={{ display: 'flex', gap: '1rem' }}>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowAppointmentModal(false)}\n                  style={{ flex: 1, padding: '0.75rem', background: '#95a5a6', color: 'white', border: 'none', borderRadius: '8px' }}\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  style={{ flex: 1, padding: '0.75rem', background: '#f39c12', color: 'white', border: 'none', borderRadius: '8px' }}\n                >\n                  Create Appointment\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Messages;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}